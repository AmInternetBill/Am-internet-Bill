<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Am Internet - Customer Panel</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <style>
        :root { --primary: #e2136e; --secondary: #128c7e; --bg: #f0f2f5; --accent: #007bff; --warning: #ffc107; }
        body { font-family: 'Segoe UI', Tahoma, sans-serif; background: var(--bg); margin: 0; padding: 15px; }
        .container { max-width: 500px; margin: auto; }
        
        .clock-container {
            background: #fff;
            padding: 15px;
            border-radius: 25px;
            display: inline-block;
            margin-bottom: 20px;
            box-shadow: 0 10px 25px rgba(226, 19, 110, 0.2);
            border-top: 4px solid var(--primary);
            width: 90%;
        }
        .clock-time { display: block; font-size: 32px; font-weight: 900; color: var(--primary); }
        .clock-date { display: block; font-size: 15px; color: #333; font-weight: bold; margin: 5px 0; }
        .bangla-season { 
            display: inline-block; background: var(--primary); color: white; 
            padding: 3px 12px; border-radius: 50px; font-size: 13px; font-weight: bold;
        }

        .header { text-align: center; padding: 10px 0; }
        .header h1 { 
            font-size: 45px; margin: 0; color: #fff; text-transform: uppercase;
            text-shadow: 0 0 10px var(--primary), 0 0 20px var(--primary);
            animation: glow 1.5s ease-in-out infinite alternate;
        }
        .designer-tag {
            font-size: 18px; color: #333; font-weight: bold; margin-top: 5px;
            letter-spacing: 1px; text-transform: uppercase; display: block;
        }
        
        @keyframes glow {
            from { text-shadow: 0 0 10px var(--primary), 0 0 20px var(--primary); }
            to { text-shadow: 0 0 20px var(--primary), 0 0 40px #ff4d94; }
        }
        
        .header p { color: #555; font-size: 14px; margin-top: 15px; line-height: 1.5; }
        .card { background: white; padding: 20px; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.08); margin-bottom: 25px; border-top: 5px solid var(--primary); }
        .card.complain-card { border-top-color: var(--secondary); }
        .card.service-card { border-top-color: var(--accent); }
        h3 { margin-top: 0; color: #333; display: flex; align-items: center; gap: 10px; font-size: 18px; }
        .toggle-btn { background: #f8f9fa; color: #333; border: 1px solid #ddd; cursor: pointer; padding: 10px; border-radius: 8px; width: 100%; font-weight: bold; margin-bottom: 5px; }
        #serviceList, #complainForm { display: none; margin-top: 15px; border-top: 1px solid #eee; padding-top: 10px; }
        .service-item { display: flex; justify-content: space-between; align-items: center; padding: 10px; border-bottom: 1px solid #f9f9f9; }
        .call-btn { background: var(--accent); color: white; text-decoration: none; padding: 5px 12px; border-radius: 5px; font-size: 13px; font-weight: bold; }
        .payment-box { background: #fff0f6; padding: 15px; border-radius: 10px; border: 1px dashed var(--primary); margin-bottom: 20px; }
        .pay-method { font-size: 14px; margin-bottom: 8px; color: #333; }
        .pay-method b { color: var(--primary); font-size: 16px; }
        .warning-text { background: #fff3cd; color: #856404; padding: 10px; border-radius: 8px; font-size: 13px; font-weight: bold; border-left: 5px solid var(--warning); margin-bottom: 15px; text-align: center; }
        label { display: block; margin: 10px 0 5px; font-size: 13px; font-weight: 600; color: #555; }
        input, select, textarea { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; font-size: 15px; outline: none; }
        .id-hint { font-size: 11px; color: var(--primary); font-weight: bold; margin-bottom: 5px; }
        button { width: 100%; padding: 14px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; color: white; margin-top: 15px; transition: 0.3s; font-size: 16px; }
        .btn-pay { background: var(--primary); }
        .btn-comp { background: var(--secondary); }
        .btn-admin { background: #555; margin-top: 30px; opacity: 0.6; font-size: 14px; }
        #adminDashboard { display: none; max-width: 1200px; margin: auto; padding: 20px; }
        .table-wrapper { width: 100%; overflow-x: auto; background: white; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); margin-bottom: 30px; }
        table { width: 100%; border-collapse: collapse; min-width: 800px; font-size: 13px; }
        th, td { border: 1px solid #eee; padding: 10px; text-align: center; }
        th { background: #333; color: white; }
        #passChangeSection { display: none; background: #f9f9f9; padding: 15px; border-radius: 10px; border: 1px solid #ddd; margin-bottom: 20px; }
        .toggle-pass-btn { background: #444; color: white; padding: 8px 15px; border-radius: 5px; font-size: 12px; cursor: pointer; border: none; margin-bottom: 10px; width: auto; }
        .del-btn { background: #ff4d4d; color: white; border: none; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 11px; }
        .section-title { background: #333; color: white; padding: 10px; border-radius: 5px; margin-bottom: 10px; text-align: center; }
        .stats-summary { display: flex; gap: 15px; margin-bottom: 20px; justify-content: center; }
        .stat-card { background: white; padding: 15px; border-radius: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); text-align: center; flex: 1; border-bottom: 4px solid var(--primary); }
        .stat-card span { display: block; font-size: 12px; color: #666; font-weight: bold; }
        .stat-card b { font-size: 18px; color: var(--primary); }
        .search-container { margin-bottom: 20px; position: sticky; top: 0; z-index: 100; background: var(--bg); padding: 10px 0; }
        #adminSearch { padding: 15px; border: 2px solid var(--primary); border-radius: 50px; font-weight: bold; }
        .month-select-container { text-align: center; margin: 20px 0; }
        #monthSelector { padding: 15px 30px; border-radius: 50px; background: var(--primary); color: white; border: none; font-size: 18px; font-weight: bold; cursor: pointer; outline: none; box-shadow: 0 4px 10px rgba(226, 19, 110, 0.3); }
    </style>
</head>
<body>

<div class="container" id="mainContainer">
    <div class="header">
        <div class="clock-container">
            <span class="clock-time" id="liveTimeBN">‡ß¶‡ß¶:‡ß¶‡ß¶:‡ß¶‡ß¶</span>
            <span class="clock-date" id="liveDateBN">‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</span>
            <span class="bangla-season" id="banglaSeason">‡¶≤‡ßã‡¶°‡¶ø‡¶Ç...</span>
        </div>
        
        <h1>Am Internet</h1>
        <span class="designer-tag">Design by Salman</span>
        <p>‡¶¶‡ßç‡¶∞‡ßÅ‡¶§ ‡¶ó‡¶§‡¶ø‡¶∞ ‡¶á‡¶®‡ßç‡¶ü‡¶æ‡¶∞‡¶®‡ßá‡¶ü ‡¶∏‡ßá‡¶¨‡¶æ ‡¶ì ‡¶®‡¶ø‡¶∞‡¶¨‡¶ö‡ßç‡¶õ‡¶ø‡¶®‡ßç‡¶® ‡¶∏‡¶Ç‡¶Ø‡ßã‡¶ó ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶ï‡¶∞‡¶æ‡¶á ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶≤‡¶ï‡ßç‡¶∑‡ßç‡¶Ø‡•§</p>
    </div>

    <div id="userPage">
        <div class="card service-card">
            <h3>üìû ‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶™‡ßã‡¶∞‡ßç‡¶ü</h3>
            <button class="toggle-btn" onclick="toggleService()">‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶ø‡¶∏ ‡¶ü‡¶ø‡¶Æ‡ßá‡¶∞ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶® ‚ñº</button>
            <div id="serviceList">
                <div class="service-item"><span>‡¶á‡¶û‡ßç‡¶ú‡¶ø‡¶®‡¶ø‡¶Ø‡¶º‡¶æ‡¶∞ ‡ßß ‡¶∞‡¶æ‡ßü‡¶π‡¶æ‡¶®</span> <a href="tel:01308667489" class="call-btn">‡¶ï‡¶≤ ‡¶¶‡¶ø‡¶®</a></div>
                <div class="service-item"><span>‡¶á‡¶û‡ßç‡¶ú‡¶ø‡¶®‡¶ø‡¶Ø‡¶º‡¶æ‡¶∞ ‡ß® ‡¶Ö‡¶≤‡¶ø </span> <a href="tel:01308667487" class="call-btn">‡¶ï‡¶≤ ‡¶¶‡¶ø‡¶®</a></div>
                <div class="service-item"><span>‡¶á‡¶û‡ßç‡¶ú‡¶ø‡¶®‡¶ø‡¶Ø‡¶º‡¶æ‡¶∞ ‡ß© ‡¶∏‡¶æ‡¶ó‡¶∞</span> <a href="tel:01308667490" class="call-btn">‡¶ï‡¶≤ ‡¶¶‡¶ø‡¶®</a></div>
            </div>
        </div>

        <div class="card">
            <h3>üí≥ ‡¶á‡¶®‡ßç‡¶ü‡¶æ‡¶∞‡¶®‡ßá‡¶ü ‡¶¨‡¶ø‡¶≤ ‡¶™‡ßá</h3>
            <div class="warning-text">‚ö†Ô∏è ‡¶∏‡¶§‡¶∞‡ßç‡¶ï‡¶¨‡¶æ‡¶∞‡ßç‡¶§‡¶æ: ‡¶™‡¶æ‡¶∞‡ßç‡¶∏‡ßã‡¶®‡¶æ‡¶≤ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞‡ßá "Send Money" ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç ‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞‡ßá "Make Payment" ‡¶ï‡¶∞‡ßÅ‡¶®‡•§</div>
            <div class="payment-box">
                <div class="pay-method">‡¶¨‡¶ø‡¶ï‡¶æ‡¶∂ ‡¶™‡¶æ‡¶∞‡ßç‡¶∏‡ßã‡¶®‡¶æ‡¶≤: <b>01918677744</b></div>
                <div class="pay-method">‡¶¨‡¶ø‡¶ï‡¶æ‡¶∂ ‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü: <b>01703134988</b></div>
            </div>
            <label>‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶Ü‡¶á‡¶°‡¶ø (‡ß´ ‡¶°‡¶ø‡¶ú‡¶ø‡¶ü)</label>
            <div class="id-hint">‡¶â‡¶¶‡¶æ‡¶π‡¶∞‡¶£: 28001</div>
            <input type="number" id="payId" value="28" placeholder="28XXX">
            <label>‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ (‡ßß‡ßß ‡¶°‡¶ø‡¶ú‡¶ø‡¶ü)</label>
            <input type="number" id="payPhone" placeholder="01XXXXXXXXX">
            <label>‡¶ü‡¶æ‡¶ï‡¶æ‡¶∞ ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£</label><input type="number" id="payAmount" placeholder="‡ß´‡ß¶‡ß¶">
            <label>‡¶ü‡ßç‡¶∞‡¶æ‡¶®‡¶ú‡ßá‡¶ï‡¶∂‡¶® ‡¶Ü‡¶á‡¶°‡¶ø (TrxID)</label><input type="text" id="payTrx" placeholder="8N76VL...">
            <button class="btn-pay" onclick="submitData('BILL')">‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶§‡¶•‡ßç‡¶Ø ‡¶ú‡¶Æ‡¶æ ‡¶¶‡¶ø‡¶®</button>
        </div>

        <div class="card complain-card">
            <h3>‚ö†Ô∏è ‡¶Ö‡¶≠‡¶ø‡¶Ø‡ßã‡¶ó ‡¶¨‡¶ï‡ßç‡¶∏</h3>
            <button class="toggle-btn" onclick="toggleComplain()">‡¶Ö‡¶≠‡¶ø‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶§‡ßá ‡¶ö‡¶æ‡¶®? ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶® ‚ñº</button>
            <div id="complainForm">
                <label>‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶Ü‡¶á‡¶°‡¶ø (‡ß´ ‡¶°‡¶ø‡¶ú‡¶ø‡¶ü)</label>
                <input type="number" id="compName" value="28" placeholder="28XXX">
                <label>‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ (‡ßß‡ßß ‡¶°‡¶ø‡¶ú‡¶ø‡¶ü)</label>
                <input type="number" id="compPhone" placeholder="01XXXXXXXXX">
                <label>‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ‡¶∞ ‡¶ß‡¶∞‡¶®</label>
                <select id="compType">
                    <option>‡¶á‡¶®‡ßç‡¶ü‡¶æ‡¶∞‡¶®‡ßá‡¶ü ‡¶ö‡¶≤‡ßá ‡¶®‡¶æ</option><option>‡¶∏‡ßç‡¶™‡¶ø‡¶° ‡¶Ö‡¶®‡ßá‡¶ï ‡¶ï‡¶Æ</option><option>‡¶§‡¶æ‡¶∞ ‡¶ï‡¶æ‡¶ü‡¶æ ‡¶™‡ßú‡ßá‡¶õ‡ßá</option><option>‡¶Ö‡¶®‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶Ø ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ</option>
                </select>
                <label>‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§</label><textarea id="compMsg" rows="2" placeholder="‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§..."></textarea>
                <button class="btn-comp" onclick="submitData('COMPLAIN')">‡¶Ö‡¶≠‡¶ø‡¶Ø‡ßã‡¶ó ‡¶™‡¶æ‡¶†‡¶æ‡¶®</button>
            </div>
        </div>
        <button class="btn-admin" onclick="showLogin()">üîê ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶≤‡¶ó‡¶á‡¶®</button>
    </div>

    <div id="adminLogin" class="card" style="display:none;">
        <h3>‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶≤‡¶ó‡¶á‡¶®</h3>
        <input type="text" id="adminUser" placeholder="Username">
        <input type="password" id="adminPass" placeholder="Password">
        <button class="btn-pay" onclick="checkLogin()">‡¶≤‡¶ó‡¶á‡¶®</button>
    </div>
</div>

<div id="adminDashboard">
    <div style="display:flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
        <h2>‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶ú‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶™‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤</h2>
        <button onclick="location.reload()" style="background:red; color:white; border:none; padding:8px 15px; border-radius:5px; cursor:pointer;">‡¶≤‡¶ó ‡¶Ü‡¶â‡¶ü</button>
    </div>
    
    <button class="toggle-pass-btn" onclick="togglePassBox()">‚öôÔ∏è ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</button>
    <div id="passChangeSection">
        <div style="display:flex; gap:10px; align-items: center;">
            <input type="password" id="newPass" placeholder="‡¶®‡¶§‡ßÅ‡¶® ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶°" style="padding:8px; margin:0; flex:1;">
            <button onclick="changePassword()" style="margin:0; width:120px; background:var(--primary); padding:10px; font-size:14px;">‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
        </div>
    </div>

    <div class="month-select-container">
        <select id="monthSelector" onchange="loadMonthData()">
        </select>
    </div>

    <div class="stats-summary">
        <div class="stat-card">
            <span>‡¶Æ‡ßã‡¶ü ‡¶¨‡¶ø‡¶≤ ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ</span>
            <b id="totalBillCount">0</b>
        </div>
        <div class="stat-card">
            <span>‡¶Æ‡ßã‡¶ü ‡¶Ü‡¶¶‡¶æ‡¶Ø‡¶º‡¶ï‡ßÉ‡¶§ ‡¶ü‡¶æ‡¶ï‡¶æ</span>
            <b id="totalBillAmount">0 TK</b>
        </div>
    </div>

    <div class="search-container">
        <input type="text" id="adminSearch" placeholder="üîç ‡¶Ü‡¶á‡¶°‡¶ø, ‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶¨‡¶æ TrxID ‡¶¶‡¶ø‡ßü‡ßá ‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßÅ‡¶®..." onkeyup="filterData()">
    </div>

    <h3 class="section-title">üí≥ ‡¶¨‡¶ø‡¶≤ ‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ</h3>
    <div class="table-wrapper">
        <table>
            <thead><tr><th>‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ</th><th>‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶Ü‡¶á‡¶°‡¶ø</th><th>‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞</th><th>‡¶ü‡¶æ‡¶ï‡¶æ‡¶∞ ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£</th><th>TrxID</th><th>‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶∂‡¶®</th></tr></thead>
            <tbody id="billTableBody"></tbody>
        </table>
    </div>

    <h3 class="section-title">‚ö†Ô∏è ‡¶Ö‡¶≠‡¶ø‡¶Ø‡ßã‡¶ó ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ</h3>
    <div class="table-wrapper">
        <table>
            <thead><tr><th>‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ</th><th>‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶Ü‡¶á‡¶°‡¶ø</th><th>‡¶Æ‡ßã‡¶æ‡¶¨‡¶æ‡¶á‡¶≤ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞</th><th>‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ‡¶∞ ‡¶ß‡¶∞‡¶®</th><th>‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§ ‡¶§‡¶•‡ßç‡¶Ø</th><th>‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶∂‡¶®</th></tr></thead>
            <tbody id="compTableBody"></tbody>
        </table>
    </div>
</div>

<script>
    const firebaseConfig = {
        apiKey: "AIzaSyCFBj-6URVjyCsO3ERZQGroPi1eWAUaV6M",
        authDomain: "sallu-c83fa.firebaseapp.com",
        databaseURL: "https://sallu-c83fa-default-rtdb.firebaseio.com",
        projectId: "sallu-c83fa",
        storageBucket: "sallu-c83fa.firebasestorage.app",
        messagingSenderId: "631719412254",
        appId: "1:631719412254:web:67b174371e595644a6e40f"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    
    function updateClock() {
        const now = new Date();
        const timeBN = now.toLocaleTimeString('bn-BD', { hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: true });
        const dayNamesBN = ["‡¶∞‡¶¨‡¶ø‡¶¨‡¶æ‡¶∞", "‡¶∏‡ßã‡¶Æ‡¶¨‡¶æ‡¶∞", "‡¶Æ‡¶ô‡ßç‡¶ó‡¶≤‡¶¨‡¶æ‡¶∞", "‡¶¨‡ßÅ‡¶ß‡¶¨‡¶æ‡¶∞", "‡¶¨‡ßÉ‡¶π‡¶∏‡ßç‡¶™‡¶§‡¶ø‡¶¨‡¶æ‡¶∞", "‡¶∂‡ßÅ‡¶ï‡ßç‡¶∞‡¶¨‡¶æ‡¶∞", "‡¶∂‡¶®‡¶ø‡¶¨‡¶æ‡¶∞"];
        const monthNamesBN = ["‡¶ú‡¶æ‡¶®‡ßÅ‡ßü‡¶æ‡¶∞‡¶ø", "‡¶´‡ßá‡¶¨‡ßç‡¶∞‡ßÅ‡ßü‡¶æ‡¶∞‡¶ø", "‡¶Æ‡¶æ‡¶∞‡ßç‡¶ö", "‡¶è‡¶™‡ßç‡¶∞‡¶ø‡¶≤", "‡¶Æ‡ßá", "‡¶ú‡ßÅ‡¶®", "‡¶ú‡ßÅ‡¶≤‡¶æ‡¶á", "‡¶Ü‡¶ó‡¶∏‡ßç‡¶ü", "‡¶∏‡ßá‡¶™‡ßç‡¶ü‡ßá‡¶Æ‡ßç‡¶¨‡¶∞", "‡¶Ö‡¶ï‡ßç‡¶ü‡ßã‡¶¨‡¶∞", "‡¶®‡¶≠‡ßá‡¶Æ‡ßç‡¶¨‡¶∞", "‡¶°‡¶ø‡¶∏‡ßá‡¶Æ‡ßç‡¶¨‡¶∞"];
        const day = dayNamesBN[now.getDay()];
        const date = now.getDate().toLocaleString('bn-BD');
        const month = monthNamesBN[now.getMonth()];
        const year = now.getFullYear().toLocaleString('bn-BD').replace(/,/g, '');
        document.getElementById('liveTimeBN').innerText = timeBN;
        document.getElementById('liveDateBN').innerText = `üìÖ ${day}, ${date} ${month} ${year}`;
        const m = now.getMonth();
        if(m == 0 || m == 1) document.getElementById('banglaSeason').innerText = "‡¶Æ‡¶æ‡¶ò ‡¶Æ‡¶æ‡¶∏ | ‡¶∂‡ßÄ‡¶§‡¶ï‡¶æ‡¶≤ ‚ùÑÔ∏è";
        else document.getElementById('banglaSeason').innerText = "‡¶´‡¶æ‡¶≤‡ßç‡¶ó‡ßÅ‡¶® ‡¶Æ‡¶æ‡¶∏ | ‡¶¨‡¶∏‡¶®‡ßç‡¶§‡¶ï‡¶æ‡¶≤ üå∏";
    }
    setInterval(updateClock, 1000);
    updateClock();

    const monthNamesEN = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
    const curMonthYear = monthNamesEN[new Date().getMonth()] + " " + new Date().getFullYear();
    const tgToken = "7741891698:AAHaxBEa2_utaOzOPJdGUzOcOBnxzijfH8w";
    const tgChatId = "7067123155";

    function togglePassBox() { const box = document.getElementById('passChangeSection'); box.style.display = (box.style.display === 'block') ? 'none' : 'block'; }
    function changePassword() { const newPass = document.getElementById('newPass').value; if(newPass.length < 4) return alert("‡¶ï‡¶Æ‡¶™‡¶ï‡ßç‡¶∑‡ßá ‡ß™ ‡¶Ö‡¶ï‡ßç‡¶∑‡¶∞ ‡¶¶‡¶ø‡¶®!"); db.ref("admin_config/pass").set(newPass).then(() => { alert("‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶∏‡ßá‡¶≠ ‡¶π‡ßü‡ßá‡¶õ‡ßá!"); togglePassBox(); document.getElementById('newPass').value = ""; }); }
    function toggleService() { var list = document.getElementById("serviceList"); var btn = document.querySelector(".service-card .toggle-btn"); if (list.style.display === "block") { list.style.display = "none"; btn.innerHTML = "‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶ø‡¶∏ ‡¶ü‡¶ø‡¶Æ‡ßá‡¶∞ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶® ‚ñº"; } else { list.style.display = "block"; btn.innerHTML = "‡¶®‡¶Æ‡ßç‡¶¨‡¶∞‡¶ó‡ßÅ‡¶≤‡ßã ‡¶≤‡ßÅ‡¶ï‡¶ø‡ßü‡ßá ‡¶∞‡¶æ‡¶ñ‡ßÅ‡¶® ‚ñ≤"; } }
    function toggleComplain() { var form = document.getElementById("complainForm"); var btn = document.querySelector(".complain-card .toggle-btn"); if (form.style.display === "block") { form.style.display = "none"; btn.innerHTML = "‡¶Ö‡¶≠‡¶ø‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶§‡ßá ‡¶ö‡¶æ‡¶®? ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶® ‚ñº"; } else { form.style.display = "block"; btn.innerHTML = "‡¶´‡¶∞‡¶Æ‡¶ü‡¶ø ‡¶≤‡ßÅ‡¶ï‡¶ø‡ßü‡ßá ‡¶∞‡¶æ‡¶ñ‡ßÅ‡¶® ‚ñ≤"; } }

    function submitData(type) {
        const inputId = (type === 'BILL') ? document.getElementById('payId').value : document.getElementById('compName').value;
        const phoneNum = (type === 'BILL') ? document.getElementById('payPhone').value : document.getElementById('compPhone').value;
        
        // Validation check
        if(type === 'BILL') {
            const amt = document.getElementById('payAmount').value;
            const trx = document.getElementById('payTrx').value;
            if(!inputId || !phoneNum || !amt || !trx) return alert("‡¶∏‡¶¨ ‡¶ò‡¶∞ ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®!");
        } else {
            const msg = document.getElementById('compMsg').value;
            if(!inputId || !phoneNum || !msg) return alert("‡¶∏‡¶¨ ‡¶ò‡¶∞ ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®!");
        }

        if (inputId.length !== 5 || !inputId.startsWith("28")) return alert("‡¶≠‡ßÅ‡¶≤ ‡¶Ü‡¶á‡¶°‡¶ø!");
        if (phoneNum.length !== 11) return alert("‡¶≠‡ßÅ‡¶≤ ‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞!");

        let payload = { type: type, month: curMonthYear, time: new Date().toLocaleString(), id: inputId, phone: phoneNum };
        let tgMsg = ""; 

        if(type === 'BILL') {
            payload.amt = document.getElementById('payAmount').value;
            payload.trx = document.getElementById('payTrx').value;
            tgMsg = `üí∞ ‡¶®‡¶§‡ßÅ‡¶® ‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü!\n‡¶Ü‡¶á‡¶°‡¶ø: ${payload.id}\n‡¶ü‡¶æ‡¶ï‡¶æ: ${payload.amt} TK\n‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤: ${payload.phone}\nTrxID: ${payload.trx}`;
        } else {
            payload.issue = document.getElementById('compType').value;
            payload.msg = document.getElementById('compMsg').value;
            tgMsg = `‚ö†Ô∏è ‡¶®‡¶§‡ßÅ‡¶® ‡¶Ö‡¶≠‡¶ø‡¶Ø‡ßã‡¶ó!\n‡¶Ü‡¶á‡¶°‡¶ø: ${payload.id}\n‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤: ${payload.phone}\n‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ: ${payload.issue}\n‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§: ${payload.msg}`;
        }

        db.ref("records").push().set(payload).then(() => { 
            fetch(`https://api.telegram.org/bot${tgToken}/sendMessage?chat_id=${tgChatId}&text=${encodeURIComponent(tgMsg)}`)
            .then(() => {
                if(type === 'COMPLAIN') {
                    alert("‡¶∂‡ßÄ‡¶ò‡ßç‡¶∞‡¶á ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶ø‡¶∏ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶®‡¶ø‡¶ß‡¶ø ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶¨‡ßá‡•§");
                } else {
                    alert("‡¶∏‡¶´‡¶≤ ‡¶π‡ßü‡ßá‡¶õ‡ßá!");
                }
                location.reload();
            });
        });
    }

    function showLogin() { document.getElementById('userPage').style.display = 'none'; document.getElementById('adminLogin').style.display = 'block'; }
    function checkLogin() {
        const u = document.getElementById('adminUser').value;
        const p = document.getElementById('adminPass').value;
        db.ref("admin_config/pass").once("value").then((snap) => {
            if(u === "Sallu" && p === (snap.val() || "Sallu12")) {
                document.getElementById('mainContainer').style.display = 'none';
                document.getElementById('adminDashboard').style.display = 'block';
                initMonthSelector();
            } else { alert("‡¶≠‡ßÅ‡¶≤!"); }
        });
    }
    function initMonthSelector() {
        const selector = document.getElementById('monthSelector');
        selector.innerHTML = "<option value='ALL'>All Data</option>";
        monthNamesEN.forEach(m => {
            let mY = m + " " + new Date().getFullYear();
            let opt = document.createElement('option');
            opt.value = mY; opt.innerHTML = mY;
            if(mY === curMonthYear) opt.selected = true;
            selector.appendChild(opt);
        });
        loadMonthData();
    }
    function filterData() {
        let input = document.getElementById('adminSearch').value.toLowerCase();
        let trs = document.querySelectorAll("tbody tr");
        trs.forEach(tr => tr.style.display = tr.textContent.toLowerCase().includes(input) ? "" : "none");
    }
    function deleteRecord(key) { if(confirm("‡¶°‡¶ø‡¶≤‡¶ø‡¶ü?")) db.ref("records/" + key).remove(); }
    function loadMonthData() {
        const selectedMonth = document.getElementById('monthSelector').value;
        let query = db.ref("records");
        if (selectedMonth !== "ALL") query = query.orderByChild("month").equalTo(selectedMonth);
        query.on("value", (snap) => {
            document.getElementById('billTableBody').innerHTML = "";
            document.getElementById('compTableBody').innerHTML = "";
            let count = 0, total = 0;
            snap.forEach((child) => {
                const d = child.val();
                const tr = document.createElement("tr");
                if(d.type === 'BILL') {
                    count++; total += Number(d.amt);
                    tr.innerHTML = `<td>${d.time}</td><td>${d.id}</td><td>${d.phone}</td><td>${d.amt} TK</td><td>${d.trx}</td><td><button class="del-btn" onclick="deleteRecord('${child.key}')">‡¶°‡¶ø‡¶≤‡¶ø‡¶ü</button></td>`;
                    document.getElementById('billTableBody').prepend(tr);
                } else {
                    tr.innerHTML = `<td>${d.time}</td><td>${d.id}</td><td>${d.phone}</td><td>${d.issue}</td><td>${d.msg}</td><td><button class="del-btn" onclick="deleteRecord('${child.key}')">‡¶°‡¶ø‡¶≤‡¶ø‡¶ü</button></td>`;
                    document.getElementById('compTableBody').prepend(tr);
                }
            });
            document.getElementById('totalBillCount').innerText = count;
            document.getElementById('totalBillAmount').innerText = total + " TK";
        });
    }
</script>
</body>
</html>
